<!doctype html>
<html>

<head>
    <% include ../partials/header.ejs %>
    <title>Socket.IO chat</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/lobby.css">
</head>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>


<script type="text/javascript">  
    var socket = io.connect('localhost:5000')
    var roomCode
    var type = "<%=room%>"
    var user = "<%=username%>"

    if(type == "create"){
        socket.emit('create')
    }
    else{
        console.log(roomCode)
        if("<%=code%>")
        roomCode = "<%=code%>"
        socket.emit('join', roomCode, user)
    }
    
    socket.on('roomcode', function(code){
        roomCode = code
        socket.emit('join', roomCode, user)
    })

    socket.on('message', function(name){
        console.log(name)
    })

    $(function() {
        $('form').submit(function(e){
            e.preventDefault() //prevents page reload
            socket.emit('joinRoom', $('#m').val())
            $('#m').val('')
            return false
        })
    }) 
</script>


<body>
    <!-- NAVBAR -->
  <% include ../partials/nav.ejs %>

  <div class="content">
    <div class="actions">

      <div class="title arvo">
        Lobby
      </div>

      <div class="container">

        <div class="row">
          <div class="col-12 col-md-10 btn-row"> <!-- players list -->
            <table class="table table-dark">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Ready</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>readyState</td>
                    </tr>
                </tbody>
            </table>
          </div>

          <div class="col-12 col-md-2 btn-row"> <!-- genres drop down-->
            <div class="row-6 row-md-12">
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Genre
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <!-- all genres -->
                        <button class="dropdown-item">Pop</button>
                        <button class="dropdown-item">Rap</button>
                        <button class="dropdown-item">Country</button>
                        <button class="dropdown-item">Hip Hop</button>
                        <button class="dropdown-item">Rock</button>
                        <button class="dropdown-item">Trap</button>
                    </div>
                </div>
            </div>
            <div class="row-6 row-md-12 subRow"> <!-- number of players in room -->
                <div class="card">
                    <div class="card-body numPlayers">
                        x/8
                    </div>
                </div>
            </div>
          </div>
        </div>

        <div class="row">

            <div class="col-12 col-md-10 btn-row"> <!-- chat -->
                <div class="chatBox">
                    <ul id="messages">
                        <li>Chat</li>
                    </ul>
                    <form action="" method="POST" id="chatForm">
                        <input type="text" id="chatInput" autocomplete="off" autofocus="on" placeholder="type your message here"><button>Send</button>
                    </form>
                </div>
            </div>

            <div class="col-12 col-md-2 btn-row">

                <div class="row-6 row-md-12"> <!-- ready button-->
                    <button type="submit" class="btn btn-outline-light btn-lg actionBtns">Ready</button>
                </div>

                <div class="row-6 row-md-6 subRowLeave"> <!-- leave button-->
                    <button type="submit" class="btn btn-outline-light btn-lg actionBtns">Leave</button>
                </div>

            </div>

        </div>

      </div>
    </div>

  </div>
</body>

</html>